![image](https://github.com/CS-TeamStudy/CS_Study_for_Interview/assets/116873887/f9f2a6f4-4fd7-4ca5-9dce-5ec20e8c8888)## 프로세스 동기화 (Process Synchronization)

### 프로세스 동기화란?

여러 프로세스가 **공유하는 자원의 일관성을 유지하는 것**입니다.<br />
이를 위해서 공유하는 자원에 하나의 프로세스만 이용하도록 제어합니다.

### 공유 자원이란?

공유 자원(Shared Resource)은 **시스템 안에서 각 프로세스, 스레드가 함께 접근할 수 있는 모니터, 프린터, 메모리, 파일, 데이터 등의 자원이나 변수 등을 의미**합니다. 이 공유 자원을 두 개 이상의 프로세스가 동시에 읽거나 쓰는 상황을 **경쟁 상태(Race Condition)** 이라고 합니다. 

![image](https://github.com/CS-TeamStudy/CS_Study_for_Interview/assets/116873887/08ff4b26-b6ce-42ec-ab2e-0f9a506197b1)

💡 데이터의 최종 연산 결과는 마지막에 해당 데이터를 다룬 프로세스에 따라 달라지기 때문에,<br />
여러 프로세스가 동시에 공유 자원에 접근할 경우 **데이터 불일치 문제가 발생**할 수 있습니다.<br />
데이터의 일관성을 유지하기 위해서는 프로세스 실행 순서를 정해주는 매커니즘(동기화)가 필요합니다.

<br />

## 어떻게 해결해야 할까?

### 임계 영역이란?

임계 영역(Critical Section)은 **둘 이상의 프로세스, 스레드가 공유 자원에 접근할 때 순서 등의 이유로 결과가 달라지는 코드 영역을 의미**합니다. 임계 영역을 해결하기 위해서는 크게 **뮤텍스, 세마포어, 모니터** 세 가지 방법이 있으며 이 방법들 모두 **상호 배제, 한정 대기, 융통성**이라는 조건을 만족합니다. 그리고 이 방법에 토대가 되는 메커니즘은 **잠금(lock)** 입니다.

- **상호 배제** : 하나의 프로세스가 임계 영역에 들어갔을 때, 다른 프로세스는 접근할 수 없다.
- **한정 대기** : 특정 프로세스가 영원히 임계 영역에 들어가지 못하면 안 된다.
- **융통성** : 하나의 프로세스가 다른 프로세스의 일을 방해하면 안 된다.
- **잠금(lock)** : 임계 영역을 하나의 공간이라고 생각했을 때, 해당 공간에 사람이 들어가 문을 잠글 경우 다른 사람은 공간에 접근할 수 없는 것을 의미한다. 공간에 잠금이 풀리고 사용 중이던 사람이 나올 때까지 기다렸다가 사용해야 한다.

### 뮤텍스

뮤텍스(Mutex)는 프로세스나 스레드가 공유 자원을 `lock()`을 통해 잠금 설정하고 사용한 후에는 `unlock()`을 통해 잠금 해제하는 객체입니다. 잠금되면 다른 프로세스나 스레드는 잠긴 코드 영역에 접근할 수 없고, 잠금이 해제되면 접근할 수 있습니다. 뮤텍스는 잠금 또는 잠금 해제라는 2가지 상태만을 가집니다.

![image](https://github.com/CS-TeamStudy/CS_Study_for_Interview/assets/116873887/959b2aed-8fb7-4e85-9978-89efb4ab9948)

### 세마포어

세마포어(Semaphore)는 일반화된 뮤텍스입니다. 간단한 정수 값과 두가지 함수 `wait()` ****및 `signal()` ****(혹은 P와 V함수라고도 부름)로 공유 자원에 대한 접근을 처리합니다.

- `wait()` : 자신의 차례가 올 때까지 기다리는 함수
- `signal()` : 다음 프로세스로 순서를 넘겨주는 함수

![image](https://github.com/CS-TeamStudy/CS_Study_for_Interview/assets/116873887/50548f6e-3ef5-41ff-bbee-3f8bbb290000)

프로세스나 스레드가 공유 자원에 접근하면 세마포어에서 `wait()` 작업을 수행하고, 프로세스나 스레드가 공유 자원을 해제할 경우 세마포어에서 `signal()` 작업을 수행합니다. 세마포어에는 조건 변수가 없고 어떤 프로세스나 스레드가 세마포어 값을 수정할 때 다른 프로세스나 스레드는 동시에 세마포어 값을 수정할 수 없습니다.

- **바이너리 세마포어 (Binary Semaphore)** <br />
    0과 1 두 가지 값만 가질 수 있는 세마포어. 뮤텍스와 유사성을 띄지만, 엄밀히 말하면 뮤텍스는 잠금 기반의 상호배제가 일어나는 ‘잠금 매커니즘’이고, 세마포어는 신호 기반의 상호 배제가 일어나는 ‘신호 매커니즘’ 입니다.
    
- **카운팅 세마포어 (Counting Semaphore)** <br />
    여러 개의 값을 가질 수 있는 세마포어. 여러 자원에 대한 접근을 제어하는 데 사용됩니다.
    

### 모니터

모니터(Monitor)는 둘 이상의 스레드나 프로세스가 공유 자원에 안전하게 접근할 수 있도록 공유 자원을 숨기고 해당 접근에 대해 인터페이스만 제공합니다. 모니터는 모니터 큐(Monitor Queue)를 통해 공유 자원에 대한 작업을 **순차적으로 처리**합니다.

![image](https://github.com/CS-TeamStudy/CS_Study_for_Interview/assets/116873887/6525b96d-139c-4e64-a83d-e611fa7e239a)
